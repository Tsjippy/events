(()=>{async function e(e,t,a){s.searchParams.set("month",t),s.searchParams.set("yr",a),window.history.pushState({},"",s),document.querySelectorAll("#monthview .events-wrap:not(hidden)").forEach(e=>e.classList.add("hidden"));let r=document.querySelector(`.events-wrap[data-date="${a}-${t}"]`);if(null==r){let s=e.closest(".calendar-wrap");s.insertAdjacentHTML("beforeEnd",sim.loaderHtml),Main.adjustLoaderImageSize(s.querySelector(".loader_wrapper"),100);let r=new FormData;r.append("month",t),r.append("year",a);let o=await FormSubmit.fetchRestApi("events/get_month_html",r);o&&(e.closest(".calendar-wrap").querySelector(".loader").remove(),document.querySelector("#monthview").insertAdjacentHTML("beforeEnd",o))}else r.classList.remove("hidden");document.querySelector("div.month_selector .current").textContent=document.querySelector("select.month_selector").options[t-1].text,document.querySelector("div.year_selector .current").textContent=a}async function t(e,t,a){s.searchParams.set("yr",a),s.searchParams.set("week",t),window.history.pushState({},"",s),document.querySelectorAll("#weekview .events-wrap:not(hidden)").forEach(e=>e.classList.add("hidden"));let r=document.querySelector(`.events-wrap[data-weeknr="${t}"]`);if(null==r){let s=e.closest(".calendar-wrap");s.insertAdjacentHTML("beforeEnd",sim.loaderHtml),Main.adjustLoaderImageSize(s.querySelector(".loader_wrapper"),100);let r=new FormData;r.append("wknr",t),r.append("year",a);let o=await FormSubmit.fetchRestApi("events/get_week_html",r);o&&(e.closest(".calendar-wrap").querySelector(".loader").remove(),document.querySelector("#weekview").insertAdjacentHTML("beforeEnd",o))}else r.classList.remove("hidden");document.querySelector("div.week_selector .current").textContent=t,document.querySelector("div.year_selector .current").textContent=a}async function a(e,t="",a=""){""==t&&""==a||(document.querySelectorAll("#listview article").forEach(e=>e.remove()),s.searchParams.set("yr",a),s.searchParams.set("month",t),window.history.pushState({},"",s)),document.getElementById("listview").insertAdjacentHTML("beforeEnd",sim.loaderHtml),Main.adjustLoaderImageSize(document.getElementById("listview").querySelector(".loader_wrapper"),100);let r=new FormData;r.append("offset",e),r.append("month",t),r.append("year",a);let o=await FormSubmit.fetchRestApi("events/get_list_html",r);o&&(document.querySelector("#listview").querySelector(".loader").remove(),document.querySelector("#listview").insertAdjacentHTML("beforeEnd",o))}const s=new URL(window.location);var r=null,o=null;console.log("Events.js loaded"),document.addEventListener("click",function(a){let r=a.target;if(r.classList.contains("prevnext")&&function(a){let s=a.dataset.month,r=a.dataset.weeknr,o=a.dataset.year;null!=s?e(a,s,o):null!=r&&t(a,r,o)}(r),r.classList.contains("calendar-day")&&(a.stopPropagation(),function(e){let t=e.dataset.date;document.querySelectorAll(".event-details-wrapper:not(.hidden)").forEach(e=>e.classList.add("hidden"));let a=e.closest(".events-wrap").querySelector(`.event-details-wrapper[data-date="${t}"]`);a.classList.remove("hidden"),document.querySelectorAll(".calendar-day.selected").forEach(e=>e.classList.remove("selected")),e.classList.add("selected"),a.scrollIntoView({behavior:"auto",block:"start",inline:"center"})}(r)),r.classList.contains("calendar-hour")&&(a.stopPropagation(),function(e){let t=e.dataset.date,a=e.dataset.starttime;document.querySelectorAll(".event-details-wrapper:not(.hidden)").forEach(e=>e.classList.add("hidden"));let s=e.closest(".events-wrap").querySelector(`.event-details-wrapper[data-date="${t}"][data-starttime="${a}"]`);null==s?e.closest(".events-wrap").querySelector('.event-details-wrapper[data-date="empty"]').classList.remove("hidden"):(s.classList.remove("hidden"),document.querySelectorAll(".calendar-hour.selected").forEach(e=>e.classList.remove("selected")),e.classList.add("selected"),Main.isMobileDevice()?(window.scrollTo(0,s.offsetTop),console.log("scrolling")):(s.scrollIntoView({behavior:"auto",block:"start",inline:"center"}),window.scrollTo(0,s.offsetHeight),console.log("scrolling")))}(r)),r.classList.contains("viewselector")&&(a.stopPropagation(),function(e){let t=e.closest(".search-form");"weekview"!=e.dataset.type&&"monthview"!=e.dataset.type||(t.querySelector("div.week_selector").classList.toggle("hidden"),t.querySelector("div.month_selector").classList.toggle("hidden")),document.querySelectorAll(".viewselector.selected").forEach(e=>e.classList.remove("selected")),e.classList.add("selected"),document.querySelectorAll(".calendarview").forEach(e=>e.classList.add("hidden")),document.getElementById(e.dataset.type).classList.remove("hidden"),s.searchParams.set("view",e.dataset.type.replace("view","")),window.history.pushState({},"",s)}(r)),"add_calendar"==r.id&&document.getElementById("calendaraddingoptions").classList.toggle("hidden"),r.classList.contains("calendarurl")&&(a.stopPropagation(),""!=r.textContent)){navigator.clipboard.writeText(r.textContent);let e={icon:"success",title:"Copied "+r.textContent,showConfirmButton:!1,timer:1500};null!=document.fullscreenElement&&(e.target=document.fullscreenElement),Swal.fire(e)}}),document.addEventListener("change",function(r){let o=r.target;if(o.classList.contains("week_selector")){r.stopPropagation();let e=o.closest(".date-search").querySelector(".year_selector").value;"weekview"==document.querySelector(".viewselector.selected").dataset.type?t(o,o.value,e):"listview"==document.querySelector(".viewselector.selected").dataset.type&&a(0,o.value,e),s.searchParams.set("week",o.value)}if(o.classList.contains("month_selector")){r.stopPropagation();let t=o.closest(".date-search").querySelector(".year_selector").value;"monthview"==document.querySelector(".viewselector.selected").dataset.type?e(o,o.value,t):"listview"==document.querySelector(".viewselector.selected").dataset.type&&a(0,o.value,t),s.searchParams.set("month",o.value)}if(o.classList.contains("year_selector")){r.stopPropagation();let l=o.closest(".date-search").querySelector(".month_selector").value;if("monthview"==document.querySelector(".viewselector.selected").dataset.type)e(o,l,o.value);else if("listview"==document.querySelector(".viewselector.selected").dataset.type)a(0,l,o.value);else if("weekview"==document.querySelector(".viewselector.selected").dataset.type){let e=o.closest(".date-search").querySelector(".week_selector").value;t(o,e,o.value)}s.searchParams.set("yr",o.value)}window.history.pushState({},"",s)}),window.onscroll=function(){let e=document.documentElement;e.scrollTop+window.innerHeight>=e.offsetHeight-2&&"listview"==document.querySelector(".viewselector.selected").dataset.type&&null==document.querySelector("#listview .loader")&&a(document.querySelector("#listview").querySelectorAll("article").length)},document.addEventListener("touchstart",function(e){const t=e.touches[0];r=t.clientX,o=t.clientY}),document.addEventListener("touchmove",function(a){if(!r||!o)return;let s,l=a.touches[0].clientX,n=a.touches[0].clientY,c=r-l,d=o-n;if(Math.abs(c)>Math.abs(d)){let r=document.querySelector(".viewselector.selected").dataset.type;s=c>0?a.target.closest(".events-wrap").querySelector(".next a"):a.target.closest(".events-wrap").querySelector(".prev a");let o=s.dataset.month,l=s.dataset.weeknr,n=s.dataset.year;"weekview"==r?t(a.target,l,n):"monthview"==r&&e(s,o,n)}r=null,o=null})})();
//# sourceMappingURL=events.min.js.map