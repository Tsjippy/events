(()=>{async function e(e,t,s){a.searchParams.set("month",t),a.searchParams.set("yr",s),window.history.pushState({},"",a),document.querySelectorAll("#monthview .events-wrap:not(hidden)").forEach((e=>e.classList.add("hidden")));let o=document.querySelector(`.events-wrap[data-date="${s}-${t}"]`);if(null==o){e.closest(".calendar-wrap").insertAdjacentHTML("beforeEnd",`<img class="loader" src="${sim.loadingGif}" style="margin-left: auto;margin-right: auto;display: block;">`);let a=new FormData;a.append("month",t),a.append("year",s);let o=await FormSubmit.fetchRestApi("events/get_month_html",a);o&&(e.closest(".calendar-wrap").querySelector(".loader").remove(),document.querySelector("#monthview").insertAdjacentHTML("beforeEnd",o))}else o.classList.remove("hidden");document.querySelector("div.month_selector .current").textContent=document.querySelector("select.month_selector").options[t-1].text,document.querySelector("div.year_selector .current").textContent=s}async function t(e,t,s){a.searchParams.set("yr",s),a.searchParams.set("week",t),window.history.pushState({},"",a),document.querySelectorAll("#weekview .events-wrap:not(hidden)").forEach((e=>e.classList.add("hidden")));let o=document.querySelector(`.events-wrap[data-weeknr="${t}"]`);if(null==o){e.closest(".calendar-wrap").insertAdjacentHTML("beforeEnd",`<img class="loader" src="${sim.loadingGif}" style="margin-left: auto;margin-right: auto;display: block;">`);let a=new FormData;a.append("wknr",t),a.append("year",s);let o=await FormSubmit.fetchRestApi("events/get_week_html",a);o&&(e.closest(".calendar-wrap").querySelector(".loader").remove(),document.querySelector("#weekview").insertAdjacentHTML("beforeEnd",o))}else o.classList.remove("hidden");document.querySelector("div.week_selector .current").textContent=t,document.querySelector("div.year_selector .current").textContent=s}async function s(e,t="",s=""){""==t&&""==s||(document.querySelectorAll("#listview article").forEach((e=>e.remove())),a.searchParams.set("yr",s),a.searchParams.set("month",t),window.history.pushState({},"",a)),document.getElementById("listview").insertAdjacentHTML("beforeEnd",'<img class="loader" src="'+sim.loadingGif+'" style="margin-left: auto;margin-right: auto;display: block;">');let o=new FormData;o.append("offset",e),o.append("month",t),o.append("year",s);let l=await FormSubmit.fetchRestApi("events/get_list_html",o);l&&(document.querySelector("#listview").querySelector(".loader").remove(),document.querySelector("#listview").insertAdjacentHTML("beforeEnd",l))}const a=new URL(window.location);var o=null,l=null;console.log("Events.js loaded"),document.addEventListener("click",(function(s){let o=s.target;if(o.classList.contains("prevnext")&&function(s){let a=s.dataset.month,o=s.dataset.weeknr,l=s.dataset.year;null!=a?e(s,a,l):null!=o&&t(s,o,l)}(o),o.classList.contains("calendar-day")&&(s.stopPropagation(),function(e){let t=e.dataset.date;document.querySelectorAll(".event-details-wrapper:not(.hidden)").forEach((e=>e.classList.add("hidden")));let s=e.closest(".events-wrap").querySelector(`.event-details-wrapper[data-date="${t}"]`);s.classList.remove("hidden"),document.querySelectorAll(".calendar-day.selected").forEach((e=>e.classList.remove("selected"))),e.classList.add("selected"),s.scrollIntoView({behavior:"auto",block:"start",inline:"center"})}(o)),o.classList.contains("calendar-hour")&&(s.stopPropagation(),function(e){let t=e.dataset.date,s=e.dataset.starttime;document.querySelectorAll(".event-details-wrapper:not(.hidden)").forEach((e=>e.classList.add("hidden")));let a=e.closest(".events-wrap").querySelector(`.event-details-wrapper[data-date="${t}"][data-starttime="${s}"]`);null==a?e.closest(".events-wrap").querySelector('.event-details-wrapper[data-date="empty"]').classList.remove("hidden"):(a.classList.remove("hidden"),document.querySelectorAll(".calendar-hour.selected").forEach((e=>e.classList.remove("selected"))),e.classList.add("selected"),Main.isMobileDevice()?(window.scrollTo(0,a.offsetTop),console.log("scrolling")):(a.scrollIntoView({behavior:"auto",block:"start",inline:"center"}),window.scrollTo(0,a.offsetHeight),console.log("scrolling")))}(o)),o.classList.contains("viewselector")&&(s.stopPropagation(),function(e){let t=e.closest(".search-form");"weekview"!=e.dataset.type&&"monthview"!=e.dataset.type||(t.querySelector("div.week_selector").classList.toggle("hidden"),t.querySelector("div.month_selector").classList.toggle("hidden")),document.querySelectorAll(".viewselector.selected").forEach((e=>e.classList.remove("selected"))),e.classList.add("selected"),document.querySelectorAll(".calendarview").forEach((e=>e.classList.add("hidden"))),document.getElementById(e.dataset.type).classList.remove("hidden"),a.searchParams.set("view",e.dataset.type.replace("view","")),window.history.pushState({},"",a)}(o)),"add_calendar"==o.id&&document.getElementById("calendaraddingoptions").classList.toggle("hidden"),o.classList.contains("calendarurl")&&(s.stopPropagation(),""!=o.textContent)){navigator.clipboard.writeText(o.textContent);let e={icon:"success",title:"Copied "+o.textContent,showConfirmButton:!1,timer:1500};null!=document.fullscreenElement&&(e.target=document.fullscreenElement),Swal.fire(e)}})),document.addEventListener("change",(function(o){let l=o.target;if(l.classList.contains("week_selector")){o.stopPropagation();let e=l.closest(".date-search").querySelector(".year_selector").value;"weekview"==document.querySelector(".viewselector.selected").dataset.type?t(l,l.value,e):"listview"==document.querySelector(".viewselector.selected").dataset.type&&s(0,l.value,e),a.searchParams.set("week",l.value)}if(l.classList.contains("month_selector")){o.stopPropagation();let t=l.closest(".date-search").querySelector(".year_selector").value;"monthview"==document.querySelector(".viewselector.selected").dataset.type?e(l,l.value,t):"listview"==document.querySelector(".viewselector.selected").dataset.type&&s(0,l.value,t),a.searchParams.set("month",l.value)}if(l.classList.contains("year_selector")){o.stopPropagation();let r=l.closest(".date-search").querySelector(".month_selector").value;if("monthview"==document.querySelector(".viewselector.selected").dataset.type)e(l,r,l.value);else if("listview"==document.querySelector(".viewselector.selected").dataset.type)s(0,r,l.value);else if("weekview"==document.querySelector(".viewselector.selected").dataset.type){let e=l.closest(".date-search").querySelector(".week_selector").value;t(l,e,l.value)}a.searchParams.set("yr",l.value)}window.history.pushState({},"",a)})),window.onscroll=function(){let e=document.documentElement;e.scrollTop+window.innerHeight>=e.offsetHeight-2&&"listview"==document.querySelector(".viewselector.selected").dataset.type&&null==document.querySelector("#listview .loader")&&s(document.querySelector("#listview").querySelectorAll("article").length)},document.addEventListener("touchstart",(function(e){const t=e.touches[0];o=t.clientX,l=t.clientY})),document.addEventListener("touchmove",(function(s){if(!o||!l)return;let a,r=s.touches[0].clientX,n=s.touches[0].clientY,c=o-r,i=l-n;if(Math.abs(c)>Math.abs(i)){let o=document.querySelector(".viewselector.selected").dataset.type;a=c>0?s.target.closest(".events-wrap").querySelector(".next a"):s.target.closest(".events-wrap").querySelector(".prev a");let l=a.dataset.month,r=a.dataset.weeknr,n=a.dataset.year;"weekview"==o?t(s.target,r,n):"monthview"==o&&e(a,l,n)}o=null,l=null}))})();
//# sourceMappingURL=events.min.js.map